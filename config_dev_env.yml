---
- hosts: dev
  user: harm
  sudo: no
  vars:
    home: /home/harm
  tasks:
    - apt: pkg=vim state=installed
      sudo: yes
    - name: get Git from PPA
      apt_repository: repo=ppa:git-core/ppa
      sudo: yes
    - apt: pkg=git update-cache=yes state=installed
      sudo: yes
    - name: get my dotfiles
      git: repo=https://github.com/haarts/dotfiles.git dest=$home/.dotfiles
      sudo: no

    # Zsh stuff
    - name: link zshenv
      file: src=$home/.dotfiles/zshenv path=$home/.zshenv state=link
    - name: link zlogin
      file: src=$home/.dotfiles/zlogin path=$home/.zlogin state=link
    - name: remove touched zshrc
      file: path=$home/.zshrc state=absent
    - name: link zshrc
      file: src=$home/.dotfiles/zshrc path=$home/.zshrc state=link

    # Vim stuff
    - name: link vimrc
      file: src=$home/.dotfiles/vimrc path=$home/.vimrc state=link
    - name: create .vim config directory
      file: path=$home/.vim state=directory
    - name: links bundles.vim, makes sure vim can initial run without errors
      file: src=$home/.dotfiles/bundles.vim path=$home/.vim/bundles.vim state=link
    - file: path=$home/.vim/bundle state=absent
    - name: Get vundle for harm
      git: repo=https://github.com/gmarik/vundle.git dest=$home/.vim/bundle/vundle
    - name: Get all defined bundles
      command: vim -u $home/.vim/bundles.vim +BundleInstall +BundleClean +qall

    # Git stuff
    - name: Link gitconfig
      file: src=$home/.dotfiles/gitconfig path=$home/.gitconfig state=link
    - name: Link gitignore
      file: src=$home/.dotfiles/gitignore path=$home/.gitignore state=link

    # Tmux stuff
    - name: Link tmux.conf
      file: src=$home/.dotfiles/tmux.conf path=$home/.tmux.conf state=link
